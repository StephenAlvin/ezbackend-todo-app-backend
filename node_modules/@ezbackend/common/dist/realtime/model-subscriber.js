"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createModelSubscriber = void 0;
var typeorm_1 = require("typeorm");
var __1 = require("..");
function createModelSubscriber(instance) {
    //URGENT TODO: Figure out if it is possible to have row level security for ALL socket.io emissions instead of checking manually for each one
    return (0, __1.DecorateClass)((0, typeorm_1.EventSubscriber)(), /** @class */ (function () {
        function ModelSubscriber() {
        }
        ModelSubscriber.prototype.afterInsert = function (event) {
            var _a;
            (_a = instance.socketIO) === null || _a === void 0 ? void 0 : _a.emit("entity_created", event.metadata.name, event.entity);
        };
        ModelSubscriber.prototype.afterUpdate = function (event) {
            var _a;
            (_a = instance.socketIO) === null || _a === void 0 ? void 0 : _a.emit("entity_updated", event.metadata.name, event.entity);
        };
        ModelSubscriber.prototype.beforeRemove = function (event) {
            var _a;
            (_a = instance.socketIO) === null || _a === void 0 ? void 0 : _a.emit("entity_deleted", event.metadata.name, event.entity);
        };
        return ModelSubscriber;
    }()));
}
exports.createModelSubscriber = createModelSubscriber;
//# sourceMappingURL=model-subscriber.js.map